import numpy as np
from specc.data.signal import Signal
from specc.plotting import plot
from tabulate import tabulate

from analysis import SELECTED_DATASETS
from tools import TemperatureConverter

all_timestamps = [
    1621495090,
    1621495119,
    1621495435,
    1622022766,
    1622022849,
    1622022887,
    1622022938,
    1622023073,
    1622023106,
    1622023306,
    1622023384,
    1622023525,
    1622023553,
    1622023569,
    1622023857,
    1622023951,
    1622024167,
    1622024940,
    1622024999,
    1622025082,
    1622025137,
    1622025465,
    1622026139,
    1622026292,
    1622026602,
    1622026695,
    1622026744,
    1622026912,
    # 1622027026,
    # 1622027106,
    # 1622027165,
    # 1622027224,
    # 1622027301,
    # 1622027320,
    1622027712,
    1622027771,
    1622027946,
    1622027976,
    1622028032,
    1622028193,
    1622028244,
    1622028445,
    1622028463,
    1622028676,
    # 1622099194,
    1622099397,
    1622099604,
    1622099648,
    1622099670,
    1622099937,
    1622100116,
    1622100158,
    1622100223,
    1622100445,
    1622100739,
    1622100817,
    1622100855,
    1622100983,
    1622101081,
    # 1622101163,
    1622101205,
    1622101412,
    1622101440,
    # 1622101457,
    1622101654,
    # 1622102106,
    1622102201,
    1622102418,
    1622102473,
    1622102557,
    1622102575,
    1622102596,
    1622103146,
    # 1622103191,
    # 1622103261,
    1622103290,
    1622103326,
    1622103857,
    1622103917,
    1622103957,
    1622104036,
    1622104137,
    1622104196,
    1622104248,
    1622104276,
    1622104324,
    1622104361,
    1622104551,
    1622104635,
    1622104786,
    1622105337,
    1622107116,
    1622107591,
    1622107611,
    1622107639,
    1622107928,
    1622107953,
    1622108541,
    1622108577,
    1622108716,
    1622109031,
    1622109333,
    1622109364,
    1622109386,
    1622110025,
    1622110042,
    # 1622110668,
    1622114165,
    1622617635,
    # 1622617767,
    # 1622617794,
    1622618527,
    1622619405,
    1622619717,
    1622619746,
    1622619820,
    1622620190,
    1622620212,
    1622620332,
    1622620403,
    1622620529,
    1622620565,
    1622620934,
    1622621136,
    1622621787,
    1622622143,
    1622622559,
    1622622647,
    1622622853,
    1622623217,
    1622623502,
    1622623979,
    # 1622624308,
    # 1622624368,
    # 1622624928,
    1622625973,
    # 1622626047,
    # 1622626084,
    1622626178,
    1622626243,
    1622626310,
    1622626393,
    1622626423,
    1622626444,
    1622626484,
    1622626515,
    1622626817,
    1622626849,
    1622627302,
    1622629049,
    1622629593,
    1622630333,
    1622630638,
    1622631421,
    1622631538,
    1622631940,
    1622632537,
    1622633323,
    1622633393,
    1622707140,
    1622712949,
]

for timestamp, name in SELECTED_DATASETS.items():
    temperature_file = f'data/temperature-{timestamp}.npz'

    temperature_converter = TemperatureConverter()

    temperature_signal = Signal.load(temperature_file, converter=temperature_converter)

    table_headers = ['Observable', 'Unit', 'Mean', 'STD']
    table_content = [
        ['Temperature', temperature_signal.converter.unit, np.mean(temperature_signal.csamples),
         np.std(temperature_signal.csamples)],
    ]

    print(tabulate(table_content, table_headers))

    plt = plot(temperature_signal, title=f'{name}\ndataset {timestamp}')
    plt.savefig(f'svg/temperature/{timestamp}.svg')
    plt.show()
